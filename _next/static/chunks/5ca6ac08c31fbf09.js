(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,82072,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(22016),i=e.i(8587),l=e.i(30314),a=e.i(25660),n=e.i(80314),o=e.i(31925),d=e.i(94868);let u="pendingSubmissionsCache";function c({term:e,initialEntries:c,allTerms:m}){let[p,h]=(0,r.useState)(""),[y,f]=(0,r.useState)([]),{showToast:g}=(0,a.useToast)(),{settings:x}=(0,n.useSettings)(),[b,v]=(0,r.useState)([]),[w,j]=(0,r.useState)(!1),[N,S]=(0,r.useState)({overall:null,minimal:null,specific:null,humorous:null}),[T,I]=(0,r.useState)([]);(0,r.useEffect)(()=>{let t=e.id.split("-")[0],r=(0,d.default)(t),s=[...r?.n||[],...r?.v||[],...r?.adj||[],...r?.adv||[]];I(m.filter(t=>t.id!==e.id&&s.includes(t.id.split("-")[0])).map(e=>({term:e,count:m.filter(t=>t.id.startsWith(e.id.split("-")[0]+"-")).length})).filter(e=>e.count>0))},[e,m]),(0,r.useEffect)(()=>{let e=()=>f((0,l.getQueue)());return e(),window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[]),(0,r.useEffect)(()=>{(async()=>{let t=[];try{t=(await (0,o.getPendingSubmissions)("https://github.com/hisyeo/gjcidlu")).submissions,localStorage.setItem(u,JSON.stringify(t))}catch(e){console.error("Error fetching pending submissions:",e),"object"==typeof e&&null!==e&&"isRateLimitError"in e&&e.isRateLimitError?g("GitHub API rate limit exceeded. Using cached pending data.","error"):g("Failed to fetch pending data. Using cached data if available.","error");try{let e=localStorage.getItem(u);e&&(t=JSON.parse(e))}catch(e){console.error("Failed to read from localStorage:",e)}}v(t.flatMap(e=>e.newEntries?.map(t=>({...t,prUrl:e.prUrl}))||[]).filter(t=>t.termId===e.id))})()},[e.id]),(0,r.useEffect)(()=>{(async()=>{if(x.userId&&x.userSystem)try{let t=await fetch("/votes.json"),r=(await t.json())[e.id];if(r){let e=r[`${x.userSystem.toLowerCase()}:${x.userId}`];if(e){let t={overall:null,minimal:null,specific:null,humorous:null};for(let r in e){let s=e[r];if(s&&s.length>0){let e=s[s.length-1];t[r]={entryId:e.entry,date:e.voted}}}S(t)}}}catch(e){console.error("Failed to fetch or parse votes.json",e)}})()},[x,e.id]);let E=(0,r.useMemo)(()=>{let t=x.userSystem&&x.userId?`${x.userSystem.toLowerCase()}:${x.userId}`:null;return Array.from(new Map([...c.map(e=>({...e,status:"published",prUrl:void 0,isCurrentUserSubmitter:e.submitter===t})),...b.map(e=>({...e,status:"pending-pr",votes:{overall:0,minimal:0,specific:0,humorous:0},isCurrentUserSubmitter:e.submitter===t})),...y.filter(t=>"NEW_ENTRY"===t.type&&t.payload.termId===e.id).map(e=>({...e.payload,status:"pending-queue",votes:{overall:0,minimal:0,specific:0,humorous:0},isCurrentUserSubmitter:!0}))].map(e=>[e.id,e])).values())},[c,b,y,e.id,x]);return(0,t.jsxs)(t.Fragment,{children:[T.length>0&&(0,t.jsxs)("div",{className:"mt-6 p-4 bg-gray-100 rounded-lg",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Related Terms"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:T.map(({term:e,count:r})=>(0,t.jsxs)(s.default,{href:`/term/${e.id}`,className:"text-blue-600 hover:underline",children:[e.id.split("-")[0]," (",r," translations)"]},e.id))})]}),(0,t.jsx)("div",{className:"mt-6",children:(0,t.jsxs)("form",{onSubmit:t=>{if(t.preventDefault(),!p.trim())return;let r=(0,i.encode)(p),s=(0,i.encodeToSnakeCaseSyllabary)(r),a=E.some(e=>e.id===s),n=y.some(t=>"NEW_ENTRY"===t.type&&t.payload.termId===e.id&&t.payload.id===s);if(a||n){g("This translation already exists or is pending review.","error"),j(!0);return}(0,l.addToQueue)({type:"NEW_ENTRY",payload:{id:s,termId:e.id,contents:r}}),h(""),j(!1),g("Translation added to queue!","success")},children:[(0,t.jsx)("input",{type:"text",value:p,onChange:e=>{h(e.target.value),j(!1)},placeholder:"Add your Hîsyêô translation...",className:`w-full rounded-lg border p-3 focus:ring-2 focus:ring-blue-500 focus:outline-none ${w?"border-red-500 focus:ring-red-500":"border-gray-300"}`}),(0,t.jsx)("button",{type:"submit",className:"mt-2 w-full rounded-lg bg-green-600 px-4 py-2 text-sm font-medium text-white hover:bg-green-700",children:"Add to Submission Queue"})]})}),(0,t.jsx)("div",{className:"mx-auto max-w-2xl",children:(0,t.jsxs)("div",{className:"mt-8 space-y-4",children:[(0,t.jsxs)("h3",{className:"text-xl font-semibold",children:["All Translations (",E.length,")"]}),E.map(r=>{let s="pending-pr"===r.status,a="pending-queue"===r.status,n=s||a,o=r.isCurrentUserSubmitter;return(0,t.jsxs)("div",{className:`rounded-lg border bg-white ${n?"border-yellow-400":"border-gray-200"}`,children:[n&&(0,t.jsxs)("div",{className:"p-2 bg-yellow-100 text-yellow-800 text-sm rounded-t-lg flex justify-between items-center",children:[(0,t.jsx)("span",{children:s?"This translation is pending review.":"This translation is in your submission queue."}),s&&r.prUrl&&(0,t.jsx)("a",{href:r.prUrl,target:"_blank",rel:"noopener noreferrer",className:"font-bold hover:underline",children:"View PR"})]}),o&&!n&&(0,t.jsx)("div",{className:"p-2 bg-green-100 text-green-800 text-sm rounded-t-lg",children:"You submitted this translation."}),(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsxs)("div",{className:"mb-3 flex items-center justify-between",children:[(0,t.jsx)("p",{className:"text-2xl font-medium text-gray-900",children:(0,i.decode)(r.contents)}),(0,t.jsxs)("button",{onClick:()=>{var e;return e=r.contents,void(h((0,i.decode)(e)),j(!1))},className:"flex items-center space-x-1 rounded-lg p-2 text-sm text-gray-500 hover:bg-gray-100 hover:text-blue-600",children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),(0,t.jsx)("span",{children:"Modify"})]})]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:["overall","minimal","specific","humorous"].map(s=>{var a;let o,d=(o=r.id,y.some(t=>"VOTE"===t.type&&t.payload.termId===e.id&&t.payload.voteType===s&&t.payload.entryId===o)),u=N[s],c=u?.entryId===r.id,m="border border-gray-400 px-3 py-1 text-sm rounded-md";d?m="bg-yellow-400 text-black px-3 py-1 text-sm rounded-md":c&&(m="bg-blue-500 text-white px-3 py-1 text-sm rounded-md");let p=c?`You voted for this on ${new Date(u.date).toLocaleDateString()}`:"";return(0,t.jsxs)("button",{onClick:()=>((t,r)=>{let s=N[r];if(s&&s.entryId===t)return void g("This vote has already been submitted.","error");let a=y.find(t=>"VOTE"===t.type&&t.payload.termId===e.id&&t.payload.voteType===r);if(a&&((0,l.removeFromQueue)(a.id),a.payload.entryId===t)||s&&s.entryId!==t&&!window.confirm(`Are you sure you want to change your '${r}' vote?`))return;(0,l.addToQueue)({type:"VOTE",payload:{termId:e.id,entryId:t,voteType:r}});let n=E.find(e=>e.id===t),o=n?(0,i.decode)(n.contents):t;g(`Vote for '${r}' on entry '${o}' added to queue!`,"success")})(r.id,s),className:m,disabled:n,title:p,children:[s.charAt(0).toUpperCase()+s.slice(1)," (",(a=r.id,(E.find(e=>e.id===a)?.votes[s]??0)+y.filter(e=>"VOTE"===e.type&&e.payload.entryId===a&&e.payload.voteType===s).length),")"]},s)})})]})]},r.id)})]})})]})}e.s(["default",()=>c])}]);